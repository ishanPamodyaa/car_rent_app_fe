<div *ngIf="isOpen" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto">
  <div class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl my-8 relative">

    <!-- Decorative Highlight -->
    <div class="absolute top-0 left-0 w-full h-2 bg-yellow-400"></div>

    <!-- Header -->
    <div class="p-8 border-b border-gray-200">
      <h2 class="text-3xl font-bold">
        <span class="text-black">{{ carData ? 'Edit' : 'Add' }}</span>
        <span class="text-yellow-500">Car</span>
      </h2>
      <p class="text-gray-500 mt-2">Fill in the details below</p>
    </div>

    <!-- Form -->
    <div class="p-8 max-h-[70vh] overflow-y-auto">
      <form (ngSubmit)="onSubmit()">

        <!-- Image Upload -->
        <div class="mb-6">
          <label class="block text-gray-700 font-bold mb-2">Car Image *</label>
          <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-yellow-400 transition">
            <input
              type="file"
              (change)="onImageSelect($event)"
              accept="image/*"
              class="hidden"
              #fileInput>

            <div *ngIf="!imagePreview" (click)="fileInput.click()" class="cursor-pointer">
              <div class="text-gray-400 mb-2">
                <svg class="w-12 h-12 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                </svg>
              </div>
              <p class="text-gray-600 font-semibold">Click to upload car image</p>
            </div>

            <div *ngIf="imagePreview" class="relative">
              <img [src]="imagePreview" class="max-h-48 mx-auto rounded-lg">
              <button
                type="button"
                (click)="imagePreview = ''; carForm.image = ''"
                class="absolute top-2 right-2 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition">
                âœ•
              </button>
            </div>
          </div>
        </div>

        <!-- Row 1: Name & Brand -->
        <div class="grid md:grid-cols-2 gap-6 mb-6">
          <div>
            <label class="block text-gray-700 font-bold mb-2">Car Name *</label>
            <input
              type="text"
              [(ngModel)]="carForm.name"
              name="name"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400 transition"
              placeholder="e.g. Corolla Altis"
              required>
          </div>

          <div>
            <label class="block text-gray-700 font-bold mb-2">Brand *</label>
            <select
              [(ngModel)]="carForm.brand"
              name="brand"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400 transition bg-white"
              required>
              <option value="">Select Brand</option>
              <option *ngFor="let brand of brands" [value]="brand">{{ brand }}</option>
            </select>
          </div>
        </div>

        <!-- Row 2: Model Year & Color -->
        <div class="grid md:grid-cols-2 gap-6 mb-6">
          <div>
            <label class="block text-gray-700 font-bold mb-2">Model Year *</label>
            <input
              type="number"
              [(ngModel)]="carForm.modelYear"
              name="modelYear"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400 transition"
              min="1990"
              [max]="currentYear + 1"
              required>
          </div>

          <div>
            <label class="block text-gray-700 font-bold mb-2">Color *</label>
            <input
              type="text"
              [(ngModel)]="carForm.color"
              name="color"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400 transition"
              placeholder="e.g. Black"
              required>
          </div>
        </div>

        <!-- Row 3: Fuel Type & Transmission -->
        <div class="grid md:grid-cols-2 gap-6 mb-6">
          <div>
            <label class="block text-gray-700 font-bold mb-2">Fuel Type *</label>
            <select
              [(ngModel)]="carForm.fuelType"
              name="fuelType"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400 transition bg-white"
              required>
              <option value="">Select Fuel Type</option>
              <option *ngFor="let fuel of fuelTypes" [value]="fuel">{{ fuel }}</option>
            </select>
          </div>

          <div>
            <label class="block text-gray-700 font-bold mb-2">Transmission *</label>
            <select
              [(ngModel)]="carForm.transmission"
              name="transmission"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400 transition bg-white"
              required>
              <option value="">Select Transmission</option>
              <option *ngFor="let trans of transmissions" [value]="trans">{{ trans }}</option>
            </select>
          </div>
        </div>

        <!-- Row 4: Mileage & Type -->
        <div class="grid md:grid-cols-2 gap-6 mb-6">
          <div>
            <label class="block text-gray-700 font-bold mb-2">Mileage (km/l)</label>
            <input
              type="number"
              [(ngModel)]="carForm.mileage"
              name="mileage"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400 transition"
              min="0"
              step="0.1">
          </div>

          <div>
            <label class="block text-gray-700 font-bold mb-2">Type *</label>
            <select
              [(ngModel)]="carForm.type"
              name="type"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400 transition bg-white"
              required>
              <option value="">Select Type</option>
              <option *ngFor="let type of carTypes" [value]="type">{{ type }}</option>
            </select>
          </div>
        </div>

        <!-- Row 5: Rental Price & Seats -->
        <div class="grid md:grid-cols-2 gap-6 mb-6">
          <div>
            <label class="block text-gray-700 font-bold mb-2">Rental Price (per day) *</label>
            <input
              type="number"
              [(ngModel)]="carForm.rentalPrice"
              name="rentalPrice"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400 transition"
              min="0"
              step="100"
              required>
          </div>

          <div>
            <label class="block text-gray-700 font-bold mb-2">Seats *</label>
            <input
              type="number"
              [(ngModel)]="carForm.seats"
              name="seats"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400 transition"
              min="2"
              max="12"
              required>
          </div>
        </div>

        <!-- Description -->
        <div class="mb-6">
          <label class="block text-gray-700 font-bold mb-2">Description</label>
          <textarea
            [(ngModel)]="carForm.description"
            name="description"
            rows="4"
            class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:border-yellow-400 focus:ring-1 focus:ring-yellow-400 transition resize-none"
            placeholder="Additional details about the car..."></textarea>
        </div>

        <!-- Buttons -->
        <div class="flex gap-4">
          <button
            type="submit"
            class="flex-1 bg-black text-white font-bold py-3 rounded-lg hover:bg-gray-800 transition transform hover:scale-[1.02] shadow-lg">
            {{ carData ? 'Update' : 'Add' }} Car
          </button>

          <button
            type="button"
            (click)="onCancel()"
            class="flex-1 bg-gray-200 text-gray-700 font-bold py-3 rounded-lg hover:bg-gray-300 transition">
            Cancel
          </button>
        </div>

      </form>
    </div>

  </div>
</div>
